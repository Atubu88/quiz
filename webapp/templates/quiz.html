<div class="quiz-wrapper">
  {% if current_category %}
    <button
      class="back-button"
      hx-get="/?category={{ current_category.id }}"
      hx-target="#content"
      hx-push-url="true"
      hx-indicator=".htmx-indicator"
    >
      ← Назад к викторинам
    </button>
  {% else %}
    <button
      class="back-button"
      hx-get="/"
      hx-target="#content"
      hx-push-url="true"
      hx-indicator=".htmx-indicator"
    >
      ← Назад к категориям
    </button>
  {% endif %}

  {% if quiz_error %}
    <p class="notice">{{ quiz_error }}</p>
  {% elif quiz %}
    <header>
      <h1>{{ quiz.title }}</h1>
      <p class="subtitle">
        {{ quiz.description or "Отвечайте на вопросы по одному и следите за прогрессом." }}
      </p>
    </header>

    {% if quiz.questions %}
      {% set total_questions = quiz.questions | length %}
      {% set first_question = quiz.questions[0] %}
      {% set next_question_id = total_questions > 1 and quiz.questions[1].id or None %}
      {% include "quiz_question.html" with
        quiz_id=quiz.id,
        quiz=quiz,
        question=first_question,
        current_question_index=1,
        total_questions=total_questions,
        correct_count=0,
        answered_count=0,
        show_result=False,
        selected_option_id=None,
        next_question_id=next_question_id,
        quiz_completed=False
      %}
    {% else %}
      <p class="empty-state">Для этой викторины пока нет вопросов.</p>
    {% endif %}
  {% else %}
    <p class="empty-state">Викторина недоступна.</p>
  {% endif %}
</div>
